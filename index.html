<!DOCTYPE html>
<html>
<head>
    <title>Live Scoreboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        @font-face { font-family: 'DSEG7'; src: url('DSEG7.ttf'); }
        body { background: black; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 0; font-family: Arial, sans-serif; color: white; overflow: hidden; }
        
        .row-container { width: 700px; margin-bottom: 2vh; display: flex; flex-direction: column; }
        .digit-row { display: grid; grid-template-columns: repeat(11, 1fr); column-gap: 2px; }
        .label-row { display: grid; grid-template-columns: repeat(3, 1fr); column-gap: 2px; }

        .label { 
            text-transform: uppercase; 
            font-weight: bold; 
            text-align: center; 
            font-size: 4.5vh; 
            color: white; 
            padding: 0.5vh 0; 
            transition: color 0.4s ease;
        }
        
        .label.inactive { color: #222; }

        .player-snug { margin-bottom: -1vh; } 
        .top-labels { margin-top: -1vh; margin-bottom: 0.5vh; }

        .cell { position: relative; width: 100%; aspect-ratio: 1 / 1.5; display: flex; justify-content: center; align-items: center; }
        .dim, .bright { font-size: 8vh; position: absolute; font-family: 'DSEG7', monospace; line-height: 1; }
        .dim { color: #110200; z-index: 1; }
        .bright { color: #ff5500; z-index: 2; text-shadow: 0 0 10px rgba(255,0,0,0.5); }

        /* Style for the clock specifically when inside a row */
        .clock-cell .bright { color: #ff5500; }
        
        .player-no .dim, .player-no .bright { font-size: 5vh; }

        #fs-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.1);
            color: #666;
            border: 1px solid #444;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 12px;
            border-radius: 4px;
            z-index: 100;
        }
        #fs-btn:hover { background: rgba(255, 255, 255, 0.2); color: white; }
        :fullscreen #fs-btn { opacity: 0; }

        @media (max-width: 767px) {
            .row-container { width: 96vw; margin-bottom: 1vh; }
            .dim, .bright { font-size: 8.5vw; }
            .player-no .dim, .player-no .bright { font-size: 5.5vw; }
            .label { font-size: 2.8vh; }
            .top-labels { margin-top: -0.5vh; }
        }
    </style>
</head>
<body>

    <button id="fs-btn" onclick="toggleFullscreen()">FULLSCREEN</button>

    <div class="row-container">
        <div id="row0" class="digit-row player-no player-snug"></div>
        <div class="label-row top-labels">
            <div id="lbl-b1" class="label">Batter</div>
            <div id="lbl-total" class="label">Total</div>
            <div id="lbl-b2" class="label">Batter</div>
        </div>
        <div id="row1" class="digit-row"></div>
    </div>

    <div class="row-container">
        <div class="label-row">
            <div id="lbl-inns" class="label">1st Inns</div>
            <div id="lbl-wickets" class="label">Wickets</div>
            <div id="lbl-overs" class="label">Overs</div>
        </div>
        <div id="row2" class="digit-row"></div>
    </div>

    <div class="row-container">
        <div class="label-row">
            <div id="lbl-dls" class="label">DLS Par</div>
            <div id="lbl-win" class="label">To Win</div>
            <div id="lbl-rem" class="label">Overs Rem</div>
        </div>
        <div id="row3" class="digit-row"></div>
    </div>

    <script>
        const NPOINT_ID = "e5ab2c288d26e7ce23ca"; 

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        function getSystemTime() {
            const now = new Date();
            const hh = now.getHours().toString().padStart(2, '0');
            const mm = now.getMinutes().toString().padStart(2, '0');
            return `${hh}:${mm}`;
        }

        async function updateScore() {
            try {
                const response = await fetch(`https://api.npoint.io/${NPOINT_ID}?t=${Date.now()}`);
                const vals = await response.json(); 
                
                if (vals && vals.length > 0) {
                    const checkLabel = (id, val) => {
                        const el = document.getElementById(id);
                        if (el) {
                            const hasData = val !== null && val !== undefined && val.toString().trim() !== "";
                            el.classList.toggle('inactive', !hasData);
                        }
                    };

                    checkLabel('lbl-b1', vals[0]);
                    checkLabel('lbl-b2', vals[1]);
                    checkLabel('lbl-total', vals[4]);
                    checkLabel('lbl-inns', vals[10]);
                    checkLabel('lbl-wickets', vals[5]);
                    checkLabel('lbl-overs', vals[6]);
                    checkLabel('lbl-dls', vals[13]);
                    checkLabel('lbl-win', vals[11]);
                    checkLabel('lbl-rem', vals[12]);

                    const pad = (v, l) => (v || "").toString().padStart(l, " ").slice(-l);
                    const clockStr = getSystemTime();

                    // Row 0 Mapping: [B1 (3 chars)] [Space (1)] [Clock (5 chars)] [Space (1)] [B2 (3 chars)]
                    // This totals 11 characters to fit your grid.
                    const rowsData = [
                        pad(vals[0], 3) + " " + clockStr + " " + pad(vals[1], 3),        
                        pad(vals[2], 3) + " " + pad(vals[4], 3) + " " + pad(vals[3], 3), 
                        pad(vals[10], 3) + "  " + pad(vals[5], 2) + "  " + pad(vals[6], 2), 
                        pad(vals[13], 3) + " " + pad(vals[11], 3) + "  " + pad(vals[12], 2)  
                    ];

                    ['row0', 'row1', 'row2', 'row3'].forEach((id, rIdx) => {
                        const container = document.getElementById(id);
                        container.innerHTML = '';
                        const chars = rowsData[rIdx].split('');
                        
                        chars.forEach((char, cIdx) => {
                            const cell = document.createElement('div');
                            cell.className = 'cell';
                            
                            // Define background "ghost" digits
                            // For Row 0: Slots 4, 5, 7, 8 are clock numbers. Slot 6 is the colon.
                            let dimChar = '8';
                            if (rIdx === 0 && cIdx === 5) dimChar = ':'; // Ghost colon
                            
                            // Don't show ghost digits on spacer columns (index 3 and 7 in standard rows)
                            // In Row 0, index 3 and 9 are the spaces around the clock.
                            const isSpacer = (rIdx === 0) ? (cIdx === 3 || cIdx === 9) : (cIdx === 3 || cIdx === 7);

                            if (!isSpacer) {
                                const d = document.createElement('div');
                                d.className = 'dim'; 
                                d.textContent = (char === ":" || (rIdx === 0 && cIdx === 5)) ? ":" : "8";
                                cell.appendChild(d);
                            }

                            if (char !== " ") {
                                const b = document.createElement('div');
                                b.className = 'bright'; 
                                b.textContent = char;
                                cell.appendChild(b);
                            }
                            container.appendChild(cell);
                        });
                    });
                }
            } catch (e) { console.log("Sync..."); }
        }

        setInterval(updateScore, 3000);
        window.onload = updateScore;
    </script>
</body>
</html>
